<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="This module contains [`Trace`]s consisting of several [`Step`]s, of which each has either an [`OutputAction`] or [`InputAction`]. This is a declarative way of modeling communication between [`Agent`]s. The [`TraceContext`] holds data, also known as [`VariableData`], which is created by [`Agent`]s during the concrete execution of the Trace. It also holds the [`Agent`]s with the references to concrete PUT."><meta name="keywords" content="rust, rustlang, rust-lang, trace"><title>puffin::trace - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceSerif4-Regular-1f7d512b176f0f72.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceSerif4-Bold-124a1ca42af929b6.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../static.files/rustdoc-93196c7a1c3542a8.css" id="mainThemeStyle"><link rel="stylesheet" id="themeStyle" href="../../static.files/light-4743e13df3dfe8c4.css"><link rel="stylesheet" disabled href="../../static.files/dark-0e1b889528bd466b.css"><link rel="stylesheet" disabled href="../../static.files/ayu-65289d5d067c7c66.css"><script id="default-settings" ></script><script src="../../static.files/storage-d43fa987303ecbbb.js"></script><script defer src="../../static.files/main-3367e395607fafc1.js"></script><noscript><link rel="stylesheet" href="../../static.files/noscript-13285aec31fa243e.css"></noscript><link rel="alternate icon" type="image/png" href="../../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="logo-container" href="../../puffin/index.html"><img class="rust-logo" src="../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2></h2></nav><nav class="sidebar"><a class="logo-container" href="../../puffin/index.html"><img class="rust-logo" src="../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2 class="location"><a href="#">Module trace</a></h2><div class="sidebar-elems"><section><ul class="block"><li><a href="#structs">Structs</a></li><li><a href="#enums">Enums</a></li></ul></section></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../static.files/wheel-5ec35bf9ca753509.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Module <a href="../index.html">puffin</a>::<wbr><a class="mod" href="#">trace</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="srclink" href="../../src/puffin/trace.rs.html#1-642">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>This module contains <a href="struct.Trace.html" title="Trace"><code>Trace</code></a>s consisting of several <a href="struct.Step.html" title="Step"><code>Step</code></a>s, of which each has either an
<a href="struct.OutputAction.html" title="OutputAction"><code>OutputAction</code></a> or <a href="struct.InputAction.html" title="InputAction"><code>InputAction</code></a>. This is a declarative way of modeling communication between
<a href="../agent/struct.Agent.html" title="Agent"><code>Agent</code></a>s. The <a href="struct.TraceContext.html" title="TraceContext"><code>TraceContext</code></a> holds data, also known as <a href="../variable_data/trait.VariableData.html" title="VariableData"><code>VariableData</code></a>, which is created by
<a href="../agent/struct.Agent.html" title="Agent"><code>Agent</code></a>s during the concrete execution of the Trace. It also holds the <a href="../agent/struct.Agent.html" title="Agent"><code>Agent</code></a>s with
the references to concrete PUT.</p>
<h4 id="serializability-of-traces"><a href="#serializability-of-traces">Serializability of Traces</a></h4>
<p>Each trace is serializable to JSON or even binary data. This helps at reproducing discovered
security vulnerabilities during fuzzing. If a trace triggers a security vulnerability we can
store it on disk and replay it when investigating the case.
As traces depend on concrete implementations as discussed in the next section we need to link
serialized data like strings or numerical IDs to functions implemented in Rust.</p>
</div></details><h2 id="structs" class="small-section-header"><a href="#structs">Structs</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.InputAction.html" title="puffin::trace::InputAction struct">InputAction</a></div><div class="item-right docblock-short">The <a href="struct.InputAction.html" title="InputAction"><code>InputAction</code></a> evaluates the recipe term and injects the newly produced message
into the <em>inbound channel</em> of the <a href="../agent/struct.Agent.html" title="Agent"><code>Agent</code></a> referenced through the corresponding <a href="struct.Step.html" title="Step"><code>Step</code></a>s
by calling <code>add_to_inbound(...)</code> and then drives the state machine forward.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Knowledge.html" title="puffin::trace::Knowledge struct">Knowledge</a></div><div class="item-right docblock-short"><a href="struct.Knowledge.html" title="Knowledge">Knowledge</a> describes an atomic piece of knowledge inferred
by the [<code>crate::variable_data::extract_knowledge</code>] function
<a href="struct.Knowledge.html" title="Knowledge">Knowledge</a> is made of the data, the agent that produced the output, the TLS message type and the internal type.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.OutputAction.html" title="puffin::trace::OutputAction struct">OutputAction</a></div><div class="item-right docblock-short">The <a href="struct.OutputAction.html" title="OutputAction"><code>OutputAction</code></a> first forwards the state machine and then extracts knowledge from the
TLS messages produced by the underlying stream by calling  <code>take_message_from_outbound(...)</code>.
An output action is automatically called after each input step.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Query.html" title="puffin::trace::Query struct">Query</a></div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Step.html" title="puffin::trace::Step struct">Step</a></div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Trace.html" title="puffin::trace::Trace struct">Trace</a></div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.TraceContext.html" title="puffin::trace::TraceContext struct">TraceContext</a></div><div class="item-right docblock-short">The <a href="struct.TraceContext.html" title="TraceContext"><code>TraceContext</code></a> contains a list of <a href="../variable_data/trait.VariableData.html" title="VariableData"><code>VariableData</code></a>, which is known as the knowledge
of the attacker. <a href="../variable_data/trait.VariableData.html" title="VariableData"><code>VariableData</code></a> can contain data of various types like for example
client and server extensions, cipher suits or session ID It also holds the concrete
references to the <a href="../agent/struct.Agent.html" title="Agent"><code>Agent</code></a>s and the underlying streams, which contain the messages
which have need exchanged and are not yet processed by an output step.</div></div></div><h2 id="enums" class="small-section-header"><a href="#enums">Enums</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.Action.html" title="puffin::trace::Action enum">Action</a></div><div class="item-right docblock-short">There are two action types <a href="struct.OutputAction.html" title="OutputAction"><code>OutputAction</code></a> and <a href="struct.InputAction.html" title="InputAction"><code>InputAction</code></a> differ.
Both actions drive the internal state machine of an <a href="../agent/struct.Agent.html" title="Agent"><code>Agent</code></a> forward by calling <code>next_state()</code>.
The <a href="struct.OutputAction.html" title="OutputAction"><code>OutputAction</code></a> first forwards the state machine and then extracts knowledge from the
TLS messages produced by the underlying stream by calling  <code>take_message_from_outbound(...)</code>.
The <a href="struct.InputAction.html" title="InputAction"><code>InputAction</code></a> evaluates the recipe term and injects the newly produced message
into the <em>inbound channel</em> of the <a href="../agent/struct.Agent.html" title="Agent"><code>Agent</code></a> referenced through the corresponding <a href="struct.Step.html" title="Step"><code>Step</code></a>s
by calling <code>add_to_inbound(...)</code> and then drives the state machine forward.
Therefore, the difference is that one step <em>increases</em> the knowledge of the attacker,
whereas the other action <em>uses</em> the available knowledge.</div></div></div></section></div></main><div id="rustdoc-vars" data-root-path="../../" data-static-root-path="../../static.files/" data-current-crate="puffin" data-themes="" data-resource-suffix="" data-rustdoc-version="1.68.2 (9eb3afe9e 2023-03-27)" data-search-js="search-98d53477a794af0b.js" data-settings-js="settings-c3c521c753752a1a.js" data-settings-css="settings-08ddfdda51b8ee2e.css" ></div></body></html>